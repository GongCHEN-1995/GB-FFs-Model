Advancing Force Fields Parameterization: A Directed Graph Attention Networks Approach

==================================================================================

Authors: Gong Chen, Théo Jaffrelot Inizan, Thomas Plé, Louis Lagardère, Jean-Philip Piquemal, Yvon Maday

Graph-Based Force Fields (GB-FFs) model is to directly derive parameters for the non-polarizable (for now) force fields from chemical environments and research into the influence of functional forms. This end-to-end parameterization approach eliminates the need for expert-defined procedures and enhances the accuracy and transferability of classical force fields across a broader range of molecular complexes.

<p align="center"><img src="figure/GB-FFs_framework.png" width=80%></p>

Dependencies
-------------

To run the code, it requires jupyter, rdkit and pytorch.

We advice the following environment:
```
conda create -n GB_FFs python=3.8
conda activate GB_FFs
conda install -c anaconda jupyter
conda install -c conda-forge openbabel
conda install -c rdkit rdkit
conda install -c conda-forge pytorch-gpu 
(or) conda install -c conda-forge pytorch
```

Model Architecture
-------------------

GB-FFs Model is composed of three inter-connected parts. 

The first is Molecule Processing Model which is used to aggregate information and extract atom/bond representations.

<p align="center"><img src="figure/GB-D_GATs_framework.png" width=80%></p>

The second part is the Charge Transfer Model which assumes that charge can move between connected atoms. Based on the bond representations from Molecule Processing Model, this part predicts the charge moves in/out for each atoms.

<p align="center"><img src="figure/GB-charge_transfer.png" width=80%></p>

Symmetry-Preserving Parameter Generator is the last part that predicts all rest force field parameters.

<p align="center"><img src="figure/GB-param_generator_framework.png" width=80%></p>


Functional Forms
-----------------

We did a preliminary investigation of the performance of different functional forms in GAFF. 

The model "GB-FFs GAFF" uses the same functional forms as original GAFF while all force field parameters are generated by our model.

The model "GB-FFs Morse" replace the harmonic function for bond strectching energy by morse function. To keep the same number of parameters, we set $\alpha$ in morse funciton as a constant 2.

The model "GB-FFs UB" applies the complete morse function for bond strectching energy. And it also considers the Urey-Bradely term

<p align="center"><img src="figure/GB-bending_distance.png" width=40%></p>

Utilization
-----------

Our work is trained for optimizing General Amber Force Field (GAFF) but it can be extended to other non-polarizable force fields without significant modifications.

To take advantage of the existing databases, we first pre-train GB-FFs models on ANI-1 database. If you want to reproduce this part, you only need to use jupyter notebook to open PreTraining.ipynb and to run the code.

The GB-FFs mdoels are then fine-tuned on SPICE and DES370K databases. If you want to reproduce this part, please use jupyter notebook to open FineTuning.ipynb and to run the code.


GB-FFs Models' performance
--------------------------

Capability to predict the atom types in GAFF:

<p align="center"><img src="figure/AT_acc.png" width=80%></p>

Performance of all models on various databases:

<p align="center"><img src="figure/results.png" width=80%></p>

New parameters for hydration free rnergy calculations:

<p align="center"><img src="figure/results.png" width=80%></p>

Citation
--------

Please kindly cite this paper if you use the code.
```
Gong Chen, Théo Jaffrelot Inizan, Thomas Plé, Louis Lagardère, Jean-Philip Piquemal, and Yvon Maday. Advancing force fields parameterization: A directed graph attention networks approach. 2023.

```

License
-------

This project is licensed under the terms of the MIT license. See [LICENSE](https://github.com/GongCHEN-1995/D-GATs/blob/main/LICENSE) for additional details.

